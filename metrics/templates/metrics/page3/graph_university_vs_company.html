
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
#divuniempresa {
display: block;
max-width: 944px;
max-height: 472px;
margin: auto;
}

</style>
<div id="div_uni_vs_com" class="col-md-12">

  <form method="POST" action="" enctype = "multipart/form-data" onsubmit="return false">
  {% csrf_token %}
  <label for="qtyuniversitycompany">Escolha o numero de elementos máximo:</label>
  <select name="qtyuniversitycompany" id="qtyuniversitycompany" onchange="this.form.submit();">
    <option value="5">5</option>
    <option value="10" selected>10</option>
    <option value="15">15</option>
    <option value="20">20</option>
  </select>
  <br>
  <label for="universityorcompany">Por:</label>
  <select name="universityorcompany" id="universityorcompany" onchange="this.form.submit();">
    <option value="Empresas" selected>Empresas</option>
    <option value="Universidades">Universidades</option>
  </select>
  <label for="valueuniversityorcompany">Visualizar:</label>
  <select name="valueuniversityorcompany" id="valueuniversityorcompany" onchange="this.form.submit();"></select>
  </form>
  <div id="divuniempresa">
  <canvas id="universidadeXempresa"></canvas>
  </div>
</div>

<script>
object_all = {{ universidadeXempresa | safe }}

if (Object.keys(object_all).length == 0)
{
    document.getElementById("div_uni_vs_com").innerHTML = "Sem informações suficientes para gerar os gráficos!";
}
else
{

document.getElementById("qtyuniversitycompany").value = object_all["Total"];

document.getElementById("universityorcompany").value = object_all["ChoosedEntity"];

select = document.getElementById("valueuniversityorcompany")

all_values = object_all["AllValues"];

for (const value of all_values)
{
	var option = document.createElement("option");
	option.value = value;
	option.text = value.charAt(0).toUpperCase() + value.slice(1);
	select.appendChild(option);
}
select.value = object_all["ChoosedValue"];

var colorArray = ['blue'];

new Chart(document.getElementById("universidadeXempresa"), {
  type: 'bar',
  data: {
    labels: object_all["Labels"],
    datasets: [{
      label : object_all["Label"],
      backgroundColor: colorArray[0],
      data: object_all["Data"]
    }]
  },
  options: {
  plugins: {
    title: {
      display: true,
      text: 'Universidade X Empresa'
    },
   },
    responsive: true
  }
  });

}
</script>
